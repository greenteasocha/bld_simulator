# CLI State Input Implementation

## 概要

`017_cli_state_input.md`の要件に基づいて、インタラクティブなキューブ状態入力機能を実装しました。

## 実装ファイル

### 1. `src/cli_state_input.rs`
新しいモジュールとして`StateInputEditor`構造体を実装しました。

#### 主な機能
- **インタラクティブな配列編集**: cp, co, ep, eoの各配列を順番に編集
- **カーソル移動**: 左右キーでカーソル位置を移動
- **値の変更**: 上下キーで値をインクリメント/デクリメント
- **フィールド切り替え**: Tabキーで次のフィールドに移動
- **確定**: Enterキーで現在のフィールドを確定し、最後のフィールド(EO)でEnterを押すと全体を確定
- **キャンセル**: Escキーで入力をキャンセル

#### UIの特徴
- 現在編集中のフィールドは緑色のボーダーで強調表示
- カーソル位置は黄色の背景で表示
- 各フィールドには説明的なタイトル付き
- 画面下部に操作方法を表示

### 2. `src/cube/state.rs`への追加
`State::from_arrays()`メソッドを追加し、`usize`配列から`State`を作成できるようにしました。

### 3. `src/main.rs`への統合
- 'i'キーで状態入力モードに入るよう統合
- ヘルプメッセージに'i'キーの説明を追加
- 入力された状態を現在のキューブ状態に設定

### 4. 使用例
`examples/state_input_demo.rs`を作成し、単体での動作確認が可能になっています。

## 使い方

### メインアプリケーションから
```bash
cargo run
```
実行後、'i'キーを押すと状態入力モードに入ります。

### デモアプリケーションで
```bash
cargo run --example state_input_demo
```

## キー操作

### 状態入力モード内
- **←/→**: カーソルを左右に移動
- **↑/↓**: 現在位置の値をインクリメント/デクリメント
- **Tab**: 次のフィールドに移動（CP → CO → EP → EO → CP）
- **Enter**: 現在のフィールドを確定（EOフィールドで押すと全体を確定して終了）
- **Esc**: 入力をキャンセルして戻る

### メインアプリケーション
- **i**: 状態入力モードに入る
- **h**: ヘルプを表示
- **d**: デバッグモードの切り替え
- **r**: キューブをリセット
- **q**: 終了

## 実装の詳細

### 値の範囲
- **CP (Corner Permutation)**: 0-7（8つのコーナー位置）
- **CO (Corner Orientation)**: 0-2（3つの向き）
- **EP (Edge Permutation)**: 0-11（12のエッジ位置）
- **EO (Edge Orientation)**: 0-1（2つの向き）

値は自動的に範囲内で循環します（例：CPで7の次は0、0から下げると7になる）。

### 初期値
すべてのフィールドは解決済み状態（solved state）で初期化されます：
- CP: [0, 1, 2, 3, 4, 5, 6, 7]
- CO: [0, 0, 0, 0, 0, 0, 0, 0]
- EP: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
- EO: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]

## テスト

単体テストは`src/cli_state_input.rs`内に実装されています：
- `test_new_editor`: エディタの初期化をテスト
- `test_increment_cp`: CP値のインクリメントとラップアラウンドをテスト
- `test_decrement_co`: CO値のデクリメントとラップアラウンドをテスト
- `test_next_field`: フィールド間の遷移をテスト

テストの実行：
```bash
cargo test cli_state_input
```

## 今後の拡張可能性

1. **プリセット**: よく使う状態をプリセットとして保存・読み込み
2. **検証**: 入力された状態が有効なキューブ状態かを検証
3. **履歴**: 以前に入力した状態の履歴機能
4. **ファイルI/O**: 状態をファイルに保存・読み込み
5. **ビジュアル表示**: 入力中の状態をキューブの展開図として表示
